var t=t||{};t.DomEvents=function(t,e){this._camera=t||null,this._domElement=e||document,this._raycaster=new THREE.Raycaster,this._selected=null,this._boundObjs={};var o=this;this._$onClick=function(){o._onClick.apply(o,arguments)},this._$onDblClick=function(){o._onDblClick.apply(o,arguments)},this._$onMouseMove=function(){o._onMouseMove.apply(o,arguments)},this._$onMouseDown=function(){o._onMouseDown.apply(o,arguments)},this._$onMouseUp=function(){o._onMouseUp.apply(o,arguments)},this._$onTouchMove=function(){o._onTouchMove.apply(o,arguments)},this._$onTouchStart=function(){o._onTouchStart.apply(o,arguments)},this._$onTouchEnd=function(){o._onTouchEnd.apply(o,arguments)},this._$onContextmenu=function(){o._onContextmenu.apply(o,arguments)},this._domElement.addEventListener("click",this._$onClick,!1),this._domElement.addEventListener("dblclick",this._$onDblClick,!1),this._domElement.addEventListener("mousemove",this._$onMouseMove,!1),this._domElement.addEventListener("mousedown",this._$onMouseDown,!1),this._domElement.addEventListener("mouseup",this._$onMouseUp,!1),this._domElement.addEventListener("touchmove",this._$onTouchMove,!1),this._domElement.addEventListener("touchstart",this._$onTouchStart,!1),this._domElement.addEventListener("touchend",this._$onTouchEnd,!1),this._domElement.addEventListener("contextmenu",this._$onContextmenu,!1)},t.DomEvents.prototype.destroy=function(){this._domElement.removeEventListener("click",this._$onClick,!1),this._domElement.removeEventListener("dblclick",this._$onDblClick,!1),this._domElement.removeEventListener("mousemove",this._$onMouseMove,!1),this._domElement.removeEventListener("mousedown",this._$onMouseDown,!1),this._domElement.removeEventListener("mouseup",this._$onMouseUp,!1),this._domElement.removeEventListener("touchmove",this._$onTouchMove,!1),this._domElement.removeEventListener("touchstart",this._$onTouchStart,!1),this._domElement.removeEventListener("touchend",this._$onTouchEnd,!1),this._domElement.removeEventListener("contextmenu",this._$onContextmenu,!1)},t.DomEvents.eventNames=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu","touchstart","touchend"],t.DomEvents.prototype._getRelativeMouseXY=function(t){var e=t.target||t.srcElement;3===e.nodeType&&(e=e.parentNode);var o={x:0,y:0},n=e,s=getComputedStyle(n,null);o.y+=parseInt(s.getPropertyValue("padding-top"),10),o.x+=parseInt(s.getPropertyValue("padding-left"),10);do o.x+=n.offsetLeft,o.y+=n.offsetTop,s=getComputedStyle(n,null),o.x+=parseInt(s.getPropertyValue("border-left-width"),10),o.y+=parseInt(s.getPropertyValue("border-top-width"),10);while(n=n.offsetParent)var i={width:e===window?window.innerWidth:e.offsetWidth,height:e===window?window.innerHeight:e.offsetHeight};return{x:2*+((t.pageX-o.x)/i.width)-1,y:-(2*((t.pageY-o.y)/i.height))+1}},t.DomEvents.prototype._objectCtxInit=function(t){t._3xDomEvent={}},t.DomEvents.prototype._objectCtxDeinit=function(t){delete t._3xDomEvent},t.DomEvents.prototype._objectCtxIsInit=function(t){return!!t._3xDomEvent},t.DomEvents.prototype._objectCtxGet=function(t){return t._3xDomEvent},t.DomEvents.prototype.camera=function(t){return t&&(this._camera=t),this._camera},t.DomEvents.prototype.bind=function(e,o,n,s){console.assert(-1!==t.DomEvents.eventNames.indexOf(o),"not available events:"+o),this._objectCtxIsInit(e)||this._objectCtxInit(e);var i=this._objectCtxGet(e);i[o+"Handlers"]||(i[o+"Handlers"]=[]),i[o+"Handlers"].push({callback:n,useCapture:s}),void 0===this._boundObjs[o]&&(this._boundObjs[o]=[]),this._boundObjs[o].push(e)},t.DomEvents.prototype.addEventListener=t.DomEvents.prototype.bind,t.DomEvents.prototype.unbind=function(e,o,n,s){console.assert(-1!==t.DomEvents.eventNames.indexOf(o),"not available events:"+o),this._objectCtxIsInit(e)||this._objectCtxInit(e);var i=this._objectCtxGet(e);i[o+"Handlers"]||(i[o+"Handlers"]=[]);for(var r=i[o+"Handlers"],u=0;u<r.length;u++){var h=r[u];if(n==h.callback&&s==h.useCapture){r.splice(u,1);break}}var c=this._boundObjs[o].indexOf(e);console.assert(-1!==c),this._boundObjs[o].splice(c,1)},t.DomEvents.prototype.removeEventListener=t.DomEvents.prototype.unbind,t.DomEvents.prototype._bound=function(t,e){var o=this._objectCtxGet(e);return!!o&&!!o[t+"Handlers"]},t.DomEvents.prototype._onMove=function(t,e,o,n){var s=this._boundObjs[t];if(void 0!==s&&0!==s.length){var i=new THREE.Vector2;i.set(e,o),this._raycaster.setFromCamera(i,this._camera);var r=this._raycaster.intersectObjects(s),u=this._selected;if(r.length>0){var h,c,v,a=r[0],m=a.object;this._selected=m,v=this._bound("mousemove",m),u!=m&&(h=this._bound("mouseover",m),c=u&&this._bound("mouseout",u))}else c=u&&this._bound("mouseout",u),this._selected=null;v&&this._notify("mousemove",m,n,a),h&&this._notify("mouseover",m,n,a),c&&this._notify("mouseout",u,n,a)}},t.DomEvents.prototype._onEvent=function(t,e,o,n){var s=this._boundObjs[t];if(void 0!==s&&0!==s.length){var i=new THREE.Vector2;i.set(e,o),this._raycaster.setFromCamera(i,this._camera);var r=this._raycaster.intersectObjects(s,!0);if(0!==r.length){for(var u=r[0],h=u.object,c=this._objectCtxGet(h),v=h.parent;void 0===c&&v;)c=this._objectCtxGet(v),v=v.parent;c&&this._notify(t,h,n,u)}}},t.DomEvents.prototype._notify=function(t,e,o,n){var s=this._objectCtxGet(e),i=s?s[t+"Handlers"]:null;if(console.assert(4==arguments.length),!s||!i||0===i.length){e.parent&&this._notify(t,e.parent,o,n);return}for(var i=s[t+"Handlers"],r=0;r<i.length;r++){var u=i[r],h=!0;u.callback({type:t,target:e,origDomEvent:o,intersect:n,stopPropagation:function(){h=!1}}),h&&!1===u.useCapture&&e.parent&&this._notify(t,e.parent,o,n)}},t.DomEvents.prototype._onMouseDown=function(t){return this._onMouseEvent("mousedown",t)},t.DomEvents.prototype._onMouseUp=function(t){return this._onMouseEvent("mouseup",t)},t.DomEvents.prototype._onMouseEvent=function(t,e){var o=this._getRelativeMouseXY(e);this._onEvent(t,o.x,o.y,e)},t.DomEvents.prototype._onMouseMove=function(t){var e=this._getRelativeMouseXY(t);this._onMove("mousemove",e.x,e.y,t),this._onMove("mouseover",e.x,e.y,t),this._onMove("mouseout",e.x,e.y,t)},t.DomEvents.prototype._onClick=function(t){this._onMouseEvent("click",t)},t.DomEvents.prototype._onDblClick=function(t){this._onMouseEvent("dblclick",t)},t.DomEvents.prototype._onContextmenu=function(t){this._onMouseEvent("contextmenu",t)},t.DomEvents.prototype._onTouchStart=function(t){return this._onTouchEvent("touchstart",t)},t.DomEvents.prototype._onTouchEnd=function(t){return this._onTouchEvent("touchend",t)},t.DomEvents.prototype._onTouchMove=function(t){if(1==t.touches.length){t.preventDefault();var e=2*+(t.touches[0].pageX/window.innerWidth)-1,o=-(2*(t.touches[0].pageY/window.innerHeight))+1;this._onMove("mousemove",e,o,t),this._onMove("mouseover",e,o,t),this._onMove("mouseout",e,o,t)}},t.DomEvents.prototype._onTouchEvent=function(t,e){if(1==e.touches.length){e.preventDefault();var o=2*+(e.touches[0].pageX/window.innerWidth)-1,n=-(2*(e.touches[0].pageY/window.innerHeight))+1;this._onEvent(t,o,n,e)}};
//# sourceMappingURL=index.0e96d95e.js.map
