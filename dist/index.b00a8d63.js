var e,t,i,r,s,n=globalThis,o={},a={},l=n.parcelRequire94c2;null==l&&((l=function(e){if(e in o)return o[e].exports;if(e in a){var t=a[e];delete a[e];var i={id:e,exports:{}};return o[e]=i,t.call(i.exports,i,i.exports),i.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){a[e]=t},n.parcelRequire94c2=l),l.register;const c=THREE.Ray;function h(e,t,i,r){this.ray=new c(e,t),this.near=i||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function d(e,t){return e.distance-t.distance}let u=0;function E(e,t,i,r){if(!1!==e.visible&&(!t.recurseFilter||t.recurseFilter(e))&&(u++,e.raycast(t,i),!0===r))for(var s=e.children,n=0,o=s.length;n<o;n++)E(s[n],t,i,!0)}Object.assign(h.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,i){var r=i||[];return E(e,this,r,t),r.sort(d),r},intersectObjects:function(e,t,i){u=0;var r=i||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var s=0,n=e.length;s<n;s++)E(e[s],this,r,t);return r.sort(d),r}});const p="enter",m="exit",f="click",w="move",y="press",g="release",v=e=>e*Math.PI/180;class b{constructor(e,t,i,r){if(this.listeners={},this.opts=r||{},this.opts.enableLaser=void 0===r.enableLaser||r.enableLaser,this.opts.laserLength=void 0!==r.laserLength?r.laserLength:3,this.opts.enableMoveEvents=void 0===r.enableMoveEvents||r.enableMoveEvents,this.scene=e,this.renderer=t,this.canvas=t.domElement,this.camera=i,this.raycaster=new h,this.waitcb=null,this.hoverTarget=null,this.intersectionFilter=this.opts.intersectionFilter||(()=>!0),this.raycaster.recurseFilter=this.opts.recurseFilter||(()=>!0),this.canvas.addEventListener("mousemove",this.mouseMove.bind(this)),this.canvas.addEventListener("click",this.mouseClick.bind(this)),this.canvas.addEventListener("mousedown",this.mouseDown.bind(this)),this.canvas.addEventListener("mouseup",this.mouseUp.bind(this)),this.canvas.addEventListener("touchstart",this.touchStart.bind(this)),this.canvas.addEventListener("touchmove",this.touchMove.bind(this)),this.canvas.addEventListener("touchend",this.touchEnd.bind(this)),this.controller1=this.renderer.vr.getController(0),this.controller1.addEventListener("selectstart",this.controllerSelectStart.bind(this)),this.controller1.addEventListener("selectend",this.controllerSelectEnd.bind(this)),this.controller2=this.renderer.vr.getController(1),this.controller2.addEventListener("selectstart",this.controllerSelectStart.bind(this)),this.controller2.addEventListener("selectend",this.controllerSelectEnd.bind(this)),this.setMouseSimulatesController(r.mouseSimulatesController),this.scene.add(this.controller1),this.scene.add(this.controller2),this.opts.enableLaser){let e=new THREE.BufferGeometry;e.addAttribute("position",new THREE.Float32BufferAttribute([0,0,0,0,0,-this.opts.laserLength],3)),e.addAttribute("color",new THREE.Float32BufferAttribute([1,.5,.5,0,0,0],3));let t=new THREE.LineBasicMaterial({vertexColors:!1,color:8912896,linewidth:5,blending:THREE.NormalBlending});this.controller1.add(new THREE.Line(e,t)),this.controller2.add(new THREE.Line(e,t))}}tick(e){this.controllerMove(this.controller1),this.controllerMove(this.controller2)}fire(e,t,i){e.dispatchEvent(i)}fireSelf(e,t){this.listeners[e]&&this.listeners[e].forEach(e=>e(t))}cameraFollowMouse(e){let t=this.canvas.getBoundingClientRect(),i=(e.clientX-t.left)/t.width*2-1,r=1-(e.clientY-t.top)/t.height*2;this.camera.rotation.y=-(2*i),this.camera.rotation.x=+r}mouseMove(e){let t=new THREE.Vector2,i=this.canvas.getBoundingClientRect();if(t.x=(e.clientX-i.left)/i.width*2-1,t.y=-(2*((e.clientY-i.top)/i.height))+1,this.raycaster.setFromCamera(t,this.camera),this.opts.mouseSimulatesController){let e=new THREE.Vector3;e.x=t.x,e.y=t.y,e.z=-3,e.add(this.camera.position),this.spot.position.copy(e),this.controller1.lookAt(e);let i=new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),v(180));this.controller1.quaternion.multiply(i)}this._processMove(),this.opts.cameraFollowMouse&&this.cameraFollowMouse(e)}touchStart(e){if(e.preventDefault(),e.changedTouches.length<=0)return;let t=e.changedTouches[0],i=new THREE.Vector2,r=this.canvas.getBoundingClientRect();i.x=(t.clientX-r.left)/r.width*2-1,i.y=-(2*((t.clientY-r.top)/r.height))+1,this.raycaster.setFromCamera(i,this.camera),this.raycaster.intersectObjects(this.scene.children,!0).filter(e=>this.intersectionFilter(e.object)).forEach(e=>{this.fire(e.object,y,{type:y})})}touchMove(e){if(e.preventDefault(),e.changedTouches.length<=0)return;let t=e.changedTouches[0],i=new THREE.Vector2,r=this.canvas.getBoundingClientRect();i.x=(t.clientX-r.left)/r.width*2-1,i.y=-(2*((t.clientY-r.top)/r.height))+1,this.raycaster.setFromCamera(i,this.camera),this._processMove()}touchEnd(e){if(e.preventDefault(),e.changedTouches.length<=0)return;let t=e.changedTouches[0],i=new THREE.Vector2,r=this.canvas.getBoundingClientRect();i.x=(t.clientX-r.left)/r.width*2-1,i.y=-(2*((t.clientY-r.top)/r.height))+1,this.raycaster.setFromCamera(i,this.camera),this.raycaster.intersectObjects(this.scene.children,!0).filter(e=>this.intersectionFilter(e.object)).forEach(e=>{this.fire(e.object,g,{type:g,point:e.point})}),this._processClick()}controllerMove(e){if(!e.visible)return;let t=new THREE.Vector3(0,0,-1);t.applyQuaternion(e.quaternion),this.raycaster.set(e.position,t),this._processMove()}_processMove(){if(!this.opts.enableMoveEvents)return;let e=this.raycaster.intersectObjects(this.scene.children,!0).filter(e=>this.intersectionFilter(e.object));if(0===e.length&&this.hoverTarget&&(this.fire(this.hoverTarget,m,{type:m}),this.hoverTarget=null),e.length>=1){let t=e[0],i=t.object;if(!i)return;this.fire(i,w,{type:w,point:t.point,intersection:t}),i===this.hoverTarget||(this.hoverTarget&&this.fire(this.hoverTarget,m,{type:m}),this.hoverTarget=i,this.fire(this.hoverTarget,p,{type:p}))}}_processClick(){if(this.waitcb){this.waitcb(),this.waitcb=null;return}let e=this.raycaster.intersectObjects(this.scene.children,!0).filter(e=>this.intersectionFilter(e.object));if(e.length>0){let t=e[0];this.fire(t.object,f,{type:f,point:t.point,intersection:t})}this.fireSelf(f,{})}mouseClick(e){let t=new THREE.Vector2,i=this.canvas.getBoundingClientRect();t.x=(e.clientX-i.left)/i.width*2-1,t.y=-(2*((e.clientY-i.top)/i.height))+1,this.raycaster.setFromCamera(t,this.camera),this._processClick()}mouseDown(e){let t=new THREE.Vector2,i=this.canvas.getBoundingClientRect();t.x=(e.clientX-i.left)/i.width*2-1,t.y=-(2*((e.clientY-i.top)/i.height))+1,this.raycaster.setFromCamera(t,this.camera),this.raycaster.intersectObjects(this.scene.children,!0).filter(e=>this.intersectionFilter(e.object)).forEach(e=>{this.fire(e.object,y,{type:y,point:e.point,intersection:e})})}mouseUp(e){let t=new THREE.Vector2,i=this.canvas.getBoundingClientRect();t.x=(e.clientX-i.left)/i.width*2-1,t.y=-(2*((e.clientY-i.top)/i.height))+1,this.raycaster.setFromCamera(t,this.camera),this.raycaster.intersectObjects(this.scene.children,!0).filter(e=>this.intersectionFilter(e.object)).forEach(e=>{this.fire(e.object,g,{type:g,point:e.point,intersection:e})})}controllerSelectStart(e){e.target.userData.isSelecting=!0,this.raycaster.intersectObjects(this.scene.children,!0).filter(e=>this.intersectionFilter(e.object)).forEach(e=>{this.fire(e.object,y,{type:y,point:e.point,intersection:e})})}controllerSelectEnd(e){e.target.userData.isSelecting=!1;let t=e.target,i=new THREE.Vector3(0,0,-1);i.applyQuaternion(t.quaternion),this.raycaster.set(t.position,i),this.raycaster.intersectObjects(this.scene.children,!0).filter(e=>this.intersectionFilter(e.object)).forEach(e=>{this.fire(e.object,g,{type:g,point:e.point})}),this._processClick()}waitSceneClick(e){this.waitcb=e}on(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}off(e,t){this.listeners[e]=this.listeners[e].filter(e=>e!==t)}setMouseSimulatesController(e){this.opts.mouseSimulatesController=e,this.opts.mouseSimulatesController&&(this.controller1=new THREE.Group,this.controller1.position.set(0,1,-2),this.controller1.quaternion.setFromUnitVectors(THREE.Object3D.DefaultUp,new THREE.Vector3(0,0,1)),this.spot=new THREE.Mesh(new THREE.SphereBufferGeometry(.1),new THREE.MeshLambertMaterial({color:"red"})),this.scene.add(this.spot))}}var T=l("7zJ5Z");const R=(e,t,i)=>e.addEventListener(t,i),H=(e,t,i)=>{let r=new THREE.Group,s=new THREE.TextureLoader;new THREE.GLTFLoader().load("./assets/birthdaycard.glb",e=>{e.scene.position.x=-1,e.scene.position.y=0,e.scene.position.z=-1,r.add(e.scene)});let n=new THREE.DirectionalLight(0xffffff,1);n.position.set(0,10,25).normalize(),r.add(n);let o=new THREE.AmbientLight(0xffffff,.3);r.add(o);let a=new THREE.PointLight(0xffffff,1.5);a.position.set(.15,2.1,-5.8),r.add(a),new THREE.TTFLoader().load("./assets/Vollkorn-BlackItalic.ttf",e=>{let t=new THREE.FontLoader().parse(e),i=new THREE.TextBufferGeometry("Happy Birthday [name]!",{font:t,size:.8,height:.2,bevelEnabled:!1,bevelThickness:.2,bevelSize:.05});i.center();let s=new THREE.Mesh(i,new THREE.MeshStandardMaterial({color:"#ff11ff",metalness:.3,roughness:.3}));s.position.set(0,3.5,-4),gsap.to(s.scale,2,{x:1.5,y:1.5,z:1.5,ease:"back.in(1.7)",yoyo:!0,repeat:-1}),r.add(s)}),r.add(t),new b(r,i,t,{intersectionFilter:e=>e.userData.clickable,cameraFollowMouse:!1,mouseSimulatesController:!1});let l=[];var c=new THREEx.DomEvents(t,i.domElement);let h=(0,T.randomMeshes)(e,[2,2,2],{color:0xffcc00},c,50),d=(0,T.agregarCubos)(e,s),u=(0,T.agregarPiramides)(e,c),E=new THREE.Mesh(new THREE.SphereGeometry(.25),new THREE.MeshLambertMaterial({color:"red"}));E.position.set(0,1,-6),E.name="cake",l.push(E);let p=new THREE.Mesh(new THREE.SphereGeometry(2.5),new THREE.MeshLambertMaterial({color:"yellow"}));p.position.set(-7,9,-25),p.name="sol",l.push(p);let m=new THREE.Mesh(new THREE.SphereGeometry(.25),new THREE.MeshLambertMaterial({color:"blue"}));m.position.set(0,1.5,0),m.name="cumple",gsap.to(m.scale,2,{x:3,y:3,z:3,ease:"power2.inOut",yoyo:!0,repeat:-1}),l.push(m),l.forEach(e=>{e.userData.clickable=!0,r.add(e),R(e,"click",e=>{if("cake"==e.target.name&&w.play(),"cumple"==e.target.name){let e=(0,T.despejarEntrada)(h);(0,T.acercarBolaAzul)(t.position,e),L.play()}"sol"==e.target.name&&H.play()})}),d.forEach((e,t)=>{e.userData.clickable=!0,r.add(e),R(e,"click",e=>{0==t&&v.play(),1==t&&y.play(),2==t&&g.play()})}),e.add(r);let f=new THREE.AudioListener;t.add(f);let w=new THREE.Audio(f),y=new THREE.Audio(f),g=new THREE.Audio(f),v=new THREE.Audio(f),H=new THREE.Audio(f),M=new THREE.Audio(f),L=new THREE.Audio(f),C=new THREE.AudioLoader;return C.load("./assets/audio/happy-birthday-music.mp3",e=>{M.setBuffer(e),M.setVolume(.4)}),C.load("./assets/audio/happy-birthday-music.mp3",e=>{L.setBuffer(e)}),C.load("./assets/audio/Hidden-message-birthday.mp3",e=>{w.setBuffer(e)}),C.load("./assets/audio/happy-birthday-crowd.mp3",e=>{y.setBuffer(e),y.setVolume(.8)}),C.load("./assets/audio/small-group-applauding.wav",e=>{g.setBuffer(e),g.setVolume(1.3)}),C.load("./assets/audio/cheers.wav",e=>{v.setBuffer(e),v.setVolume(.8)}),C.load("./assets/audio/sunshine.mp3",e=>{H.setBuffer(e),H.setVolume(1.2)}),e.add(new THREE.Mesh(new THREE.SphereGeometry(30),new THREE.MeshLambertMaterial({color:"white",map:s.load("assets/sky.jpg"),side:THREE.BackSide}))),{cubosEntrada:h,cubos:d,secreto:E,bola:m,piramides:u,audios:{sunshine:H,crowd:y,applause:g,cheers:v,hidden1:M,aleatorio:w,cumple:L}}};var T=l("7zJ5Z");const M=e=>document.querySelector(e);var T=l("7zJ5Z");[e,t,i,r,s]=(()=>{let e=document.createElement("div");document.body.appendChild(e);let t=document.querySelector("#canvas"),i=new THREE.WebGLRenderer({canvas:t,logarithmicDepthBuffer:!0,antialias:!0}),r=window.innerWidth/window.innerHeight,s=new THREE.PerspectiveCamera(70,r,.1,50);s.position.z=25,s.position.y=6;let n=new THREE.Scene;i.setSize(window.innerWidth,window.innerHeight),e.appendChild(i.domElement);let o=new THREE.OrbitControls(s,i.domElement);o.target.set(0,1,-5.3),o.minDistance=.2,o.maxDistance=25,o.maxPolarAngle=Math.PI/2;let a=H(n,s,i);return window.addEventListener("resize",()=>{s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),i.setSize(window.innerWidth,window.innerHeight)},!1),THREE.DefaultLoadingManager.onStart=(e,t,i)=>{},THREE.DefaultLoadingManager.onLoad=()=>{M("#loading-indicator").style.display="none",M("#click-to-play").style.display="block";let e=M("#overlay");marquesina(()=>{(0,T.addAnimationHide)(document.body.querySelector(".container-marquesina"))}),M("#click-to-play").getElementsByTagName("button"),document.querySelectorAll("#click-to-play button").forEach(t=>{t.addEventListener("click",t=>{(0,T.addAnimationHide)(e),a.audios.cumple.play(),setTimeout(()=>{a.audios.crowd.play()},12e3),C(s,t.target.value)})}),document.body.querySelector("#volver").addEventListener("click",()=>{(0,T.showElem)(e)},!1),document.body.querySelector("#clue").addEventListener("click",()=>{Swal?Swal.fire({title:"A clue!",text:"Look inside the cake! You can move around by clicking and dragging! Zoom in with the wheel of your mouse!",icon:"warning",confirmButtonText:"Ok"}):alert("Look inside the cake!")},!1)},THREE.DefaultLoadingManager.onProgress=(e,t,i)=>{M("#progress").setAttribute("value",t/i*100)},THREE.DefaultLoadingManager.onError=e=>{},[i,n,s,o,a]})(),t.background=new THREE.Color(0xffffff),new THREE.Raycaster,new THREE.Vector2;var L=r=>{r*=.001,s.cubos.forEach((e,t)=>{let i=r*(.2+.1*t);"principal"==e.name&&(e.rotation.x=i),e.rotation.y=i+1}),e.render(t,i),requestAnimationFrame(L)};setInterval(()=>{let e=Math.random(),t=Math.random(),i=Math.random();s.secreto.material.emissive.setRGB(e,t,i),s.secreto.material.color.setRGB(e,t,i)},500);const C=(e,t)=>{setTimeout(()=>{if("a"==t){let t=(0,T.despejarEntrada)(s.cubosEntrada);(0,T.acercarBolaAzul)(e.position,t)}},1e3)};requestAnimationFrame(L);
//# sourceMappingURL=index.b00a8d63.js.map
